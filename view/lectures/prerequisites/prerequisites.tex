%%
%% copyright quintard julien
%% 
%% kaneton
%% 
%% prerequisites.tex
%% 
%% path          /home/mycure/kaneton/view/lectures/prerequisites
%% 
%% made by mycure
%%         quintard julien   [quinta_j@epita.fr]
%% 
%% started on    Tue Jul  5 12:23:08 2005   mycure
%% last update   Tue Nov  8 05:13:20 2005   mycure
%%

%
% class
%

\documentclass[8pt]{beamer}

%
% packages
%

\usepackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade}
\usepackage{colortbl}
\usepackage{times}
\usepackage{amsmath,amssymb}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{color}
\usepackage{xcolor}
\usepackage[english]{babel}
\usepackage{enumerate}
\usepackage[latin1]{inputenc}

%
% style
%

\usepackage{beamerthemesplit}
\setbeamercovered{dynamic}

%
% verbatim font
%

\definecolor{verbatimcolor}{rgb}{0,0.4,0}

\makeatletter
\renewcommand{\verbatim@font}
  {\ttfamily\footnotesize\color{verbatimcolor}\selectfont}
\makeatother

%
% new line
%

\newcommand{\nl}[0]{\vspace{0.4cm}}

%
% title
%

\title{Prerequisites}

%
% authors
%

\author
{
  Julien~Quintard\inst{1} \\
  {\tiny julien.quintard@gmail.com}
}

\institute
{
  \inst{1} kaneton microkernel project
}

%
% date
%

\date{\today}

%
% logos
%

\pgfdeclareimage[interpolate=true,width=34pt,height=18pt]
                {epita}{../../logos/epita}
\pgfdeclareimage[interpolate=true,width=49pt,height=18pt]
                {upmc}{../../logos/upmc}
\pgfdeclareimage[interpolate=true,width=25pt,height=18pt]
                {lse}{../../logos/lse}

%
% table of contents at the beginning of each section
%

\AtBeginSection[]
{
  \begin{frame}<beamer>
   \frametitle{Outline}
    \tableofcontents[current]
  \end{frame}
}

%
% table of contents at the beginning of each subsection
%

\AtBeginSubsection[]
{
  \begin{frame}<beamer>
   \frametitle{Outline}
    \tableofcontents[current,currentsubsection]
  \end{frame}
}

%
% document
%

\begin{document}

%
% title frame
%

\begin{frame}
  \titlepage

  \begin{center}
    \pgfuseimage{epita} \hspace{0.1cm} \pgfuseimage{upmc} \hspace{0.1cm}
    \pgfuseimage{lse} \hspace{0.1cm}
  \end{center}
\end{frame}

%
% outline frame
%

\begin{frame}
  \frametitle{Outline}
  \tableofcontents
\end{frame}

%
% overview
%

\section{Overview}

% 1)

\begin{frame}
  \frametitle{Description}

  The kaneton project is a very complex project which combined very different
  techniques, concepts, languages etc..

  \nl

  We will here quickly see the prerequisites to be sure students will be
  able to success.
\end{frame}

% 2)

\begin{frame}
  \frametitle{List}

  The different prerequisites for the kaneton project are:

  \begin{itemize}[<+->]
    \item
      Advanced makefiles because the kaneton compiling system uses special
      gmake features.
    \item
      C-preprocessor because the kaneton kernel uses it in a very powerful
      and elegant way.
    \item
      Inline assembly because it is widely used in low-level programming.
    \item
      C language because without, needless to start the project.
    \item
      Assembly language because low-level programming needs it.
  \end{itemize}

  \nl

  The first three prerequisites will be coverded by dedicated courses.

  \nl

  For the two languages C and assembly, we assume you already well know these
  languages.
\end{frame}

%
% c
%

\section{C}

% 1)

\begin{frame}
  \frametitle{Overview}

  To be sure the C language is not a problem for every student we
  will view in this section some fundamental uses:

  \begin{itemize}
    \item
      Shifts.
    \item
      Bit masks.
    \item
      And more generally arithmetic and logic operators.
  \end{itemize}
\end{frame}

% 2)

\begin{frame}
  \frametitle{Shift Operators}

  \begin{itemize}[<+->]
    \item
      $<<$: shift left
    \item
      $>>$: shift right
  \end{itemize}
\end{frame}

% 3)

\begin{frame}[containsverbatim]
  \frametitle{Example}

  The best examples of shift uses are either to quickly compute power of two:

  \begin{verbatim}
    int         v = 42

    v <<= 2;    /* now v is equal to 168 */
  \end{verbatim}

  or to quickly set a bit from its position without any calculation:

  \begin{verbatim}
    #define FLAG_USER           0x1
    #define FLAG_SYSTEM         0x2
    #define FLAG_DRIVER         0x4
    #define FLAG_SERVICE        0x8
  \end{verbatim}

  instead we can do:

  \begin{verbatim}
    #define FLAG_USER           (1 << 0)
    #define FLAG_SYSTEM         (1 << 1)
    #define FLAG_DRIVER         (1 << 2)
    #define FLAG_SERVICE        (1 << 3)
  \end{verbatim}

  The result is a clearer output: we directly know which bit is set.
\end{frame}

% 4)

\begin{frame}
  \frametitle{Logic Operators}

  \begin{itemize}[<+->]
    \item
      $|$: or operator.
    \item
      \&: and operator.
    \item
      \^~: xor operator.
    \item
      \~~: not operator.
  \end{itemize}
\end{frame}

% 5)

\begin{frame}[containsverbatim]
  \frametitle{Example}

  \begin{verbatim}
    unsigned int        set(unsigned int        mask,
                            unsigned char       bit)
    {
      return (mask | (1 << bit));
    }

    unsigned int      unset(unsigned int        mask,
                            unsigned char       bit)
    {
      return (mask & ~(1 << bit));
    }
  \end{verbatim}
\end{frame}

%
% assembly
%

\section{Assembly}

% 1)

\begin{frame}
  \frametitle{Overview}

  The assembly language is absolutely fundamental in low-level programming.

  \nl

  The kaneton project is essentially developed using the C language but
  small parts must be written in assembly either to optimise the source
  code but this is obviously useless and unwanted; or to develop very
  special parts in relation with the processor.

  \nl

  These architecture source code parts are essential and very difficult.

  \nl

  For these reasons the language must not be a difficulty.
\end{frame}

% 2)

\begin{frame}
  \frametitle{Language}

  The assembly language will not be presented here because it depends
  of the architecture.

  \nl

  Please refer to the dedicated course on the architectures.
\end{frame}

%
% execution context
%

\section{Execution Context}

% 1)

\begin{frame}
  \frametitle{Overview}

  A thing students should understand is that in low-level programming
  there is no execution context.

  \nl

  This is very important because the students will so have to create for
  example their own stack, to parse the ELF binary etc..

  \nl

  To do so, every student has to perfectly understand how an address
  space is composed.
\end{frame}

% 2)

\begin{frame}
  \frametitle{Layout}

  \begin{enumerate}
    \item
      \textbf{code}: .text
    \item
      \textbf{data}: .data .rodata .bss
    \item
      \textbf{heap}
    \item
      \textbf{stack}
    \item
      \textbf{kernel}
  \end{enumerate}
\end{frame}

% 3)

\begin{frame}
  \frametitle{Stack Frames}

  Let's discuss about the stack internals and the stack frames.

  \nl

  The questions are:

  \begin{itemize}
    \item
      What does the compiler/programmer do?
    \item
      What does the processor do?
  \end{itemize}
\end{frame}

\end{document}
