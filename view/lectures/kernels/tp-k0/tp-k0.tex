%%
%% licence       kaneton licence
%%
%% project       kaneton
%%
%% file          /home/buckman/kaneton/view/lectures/kernels/tp-k0/tp-k0.tex
%%
%% created       matthieu bucchianeri   [wed jan 24 14:46:51 2007]
%% updated       matthieu bucchianeri   [wed jan 24 15:10:21 2007]
%%

%
% template
%

\input{../../../templates/paper.tex}
\usepackage{pdfpages}

%
% header
%

\lhead{\scriptsize{k0}}

%
% title
%

\title{kaneton K0\\Bootstrap}

%
% authors
%

\author{\small{Matthieu Bucchianeri} and
        \small{Renaud Voltz}}

%
% document
%

\begin{document}

\maketitle

\vspace{5mm}

\begin{tabular}{p{7cm}l}
Delivery date: & Sunday, 28th \\
               & 11:42 pm \\
Assistants : & Matthieu Bucchianeri - \small{chichelover@epita.fr} \\
             & Renaud Voltz - \small{voltz\_r@epita.fr} \\
Dedicated googlegroup: & kaneton-students \\
Programming languages: & Assembly, C \\
Architecture: & Intel 32-bit \\
Students per group: & 1
\end{tabular}

\section*{Introduction}

\newpage


\section*{implementation}

\subsection*{Exercise 1: string display}
Print a string at the (20, 10) coordinates.\\
\\
{\bf Steps:}
\begin{enumerate}
\item {\tt print\_char}\\
Print a character at the current cursor position, and update the cursor position.
\item {\tt print\_string}\\
Print the string pointed by {\em \%si} register at the cursor position and update the cursor position.
\item{\tt cursor\_set}\\
Set the cursor position.
\end{enumerate}




\subsection*{Exercise 2: libc}


  \begin{enumerate}
  \item {\tt malloc}\\
  Very stupid malloc:
  \begin{itemize}
  \item Declare the heap.
  \item Declare a break value at the begining of the heap.
  \item malloc returns the break value in {\em \%ax} and then increments it.
  \end{itemize}
  \item {\tt itoa}\\
  Basic itoa (hey, why not using it to test your malloc ?!).
  \item {\tt itoa\_hex}\\
  Hexadecimal itoa (the 0x prefix would be appreciated).
  \item {\tt strcmp}\\
  Basic strcmp : return 0 if both strings are equal, return 1 otherwise.
  \end{enumerate}


\subsection*{Exercise 3: keyboard inputs}

Write a prompt which gets a string from the keyboard and wich displays it when you press {\tt ENTER}.\\
\\
You must display alpha-numeric characters and punctuation.\\
Do not implement key combinations (using modifiers like {\tt SHIFT}, {\tt ALT}, {\tt CTRL}, \ldots).\\
Pressing {\tt ENTER} must result in a newline.\\
\\
{\em Example}:
\begin{verbatim}
Enter your name: Renaud
Hello Renaud !
\end{verbatim}
{\bf Steps:}
  \begin{enumerate}
  \item {\tt kbd\_get\_scancode}\\
  Get the next scancode from the keyboard buffer.
  \item {\tt scancode\_to\_ascii}\\
  Convert a scancode to an ASCII character.
  \end{enumerate}



\subsection*{Exercise 4: floppy drive}

Write a program which loads the bootsector of a floppy disk and which checks wether it does contain a bootloader.\\
\\
(The bootsector contains a bootloader if it is ended by the 0xAA55 magic.)\\
\\
Your program must print the magic value as shown in the following example:\\
\\
{\em Example:}
\begin{verbatim}
Loading floppy bootsector ... OK
magic found: 0xaa55

Loading floppy bootsector ... OK
ERROR: bad magic: 0xt824
\end{verbatim}
{\bf Steps:}
  \begin{enumerate}
  \item {\tt floppy\_read\_sector}\\
  Read {\em n} sectors from the floppy drive (A:).
  \end{enumerate}

\subsection*{Exercise 5: operating modes switching}

Write a program which turns the microprocessor into protected mode.

  \begin{enumerate}
  \item {\tt pmode\_enable}\\
  Switch from real mode to protected mode.
  \item {\tt memset}\\
  Basic memset function.
  \item {\tt memcpy}\\
  Basic memcpy function.
  \end{enumerate}

\subsection*{Exercise 6: ELF loader}


  \begin{enumerate}
  \item {\tt }
  \item {\tt }
  \end{enumerate}

\newpage


%
% Bios interrupts documentation
%

\section{Bios Interupts}

\subsection{Video services}
\includepdf[pages=-]{int10}
\includepdf[pages=-]{int10_2}
\includepdf[pages=-]{int10_3}
\includepdf[pages=-]{int10_e}

\subsection{Disks accesses}
\includepdf[pages=-]{int13}
\includepdf[pages=-]{int13_0}
\includepdf[pages=-]{int13_1}
\includepdf[pages=-]{int13_2}

\subsection{Keyboard}
\includepdf[pages=-]{int16}
\includepdf[pages=-]{int16_0}
\includepdf[pages=-]{int16_1}
\includepdf[pages=-]{int16_scancodes}

%
% ELF documentation
%

\section{ELF format}

\includepdf[pages=-]{elf1}
\includepdf[pages=-]{elf2}
\includepdf[pages=-]{elf3}
\includepdf[pages=-]{elf4}
\includepdf[pages=-]{elf5}
\includepdf[pages=-]{elf6}
\includepdf[pages=-]{elf7}

%
% IA-32 operating mode switch
%

\section{IA-32 operating modes}

\includepdf[pages=-]{mode_switch}

\end{document}
