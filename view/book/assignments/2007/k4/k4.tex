%%
%% licence       kaneton licence
%%
%% project       kaneton
%%
%% file          view/books/assignments/2007/k4/k4.tex
%%
%% created	 pidancet julian	[tue may29 16:34:56 2006]
%% updated	 pidancet julian	[tue may29 16:34:56 2006]
%%

%
% k2
%

\chapter{K4: IPC Management}

%
% informations
%

\begin{tabular}{p{7cm}l}
Duration: & 2 weeks \\
Directory name: & kaneton/ \\
In charge: & Julian Pidancet \& Matthieu Bucchianeri \& Renaud Voltz\\
Mailing-list: & kaneton-students@googlegroups.com \\
Languages: & C, assembly \\
Students per group: & 2 (same groups as for K3) \\
\end{tabular}

\section{Abstract}

K4 project consists in developing the last part of the microkernel : the
IPC (Inter-process Communication). As you know, in a microkernel, contrary
to a monolithic kernel, every kernel services are running independently
from the core, in separate userspace privileged tasks. Though, in order
to keep coherency, tasks need to interact : sending, receiving messages,
and also synchronizing each others. The IPC model chosen for Kaneton is
``message passing''

The concerned parts are:

\begin{enumerate}
  \item
    {\bf The message manager, messaging primitives}\\
    Inter-process messaging primitives. Send and receive functions,
    synchronous and asynchronous.
  \item
    {\bf The message manager, IA-32 Syscall Handlers}\\
    Handling kernel side soft-interrupts (syscall to the messaging primitives).
  \item
    {\bf Task side, IA-32 Syscall Triggers}\\
    Userland-side syscall Triggering (Interrupt the kernel to send a
    message from userland).

\end{enumerate}

\newpage

\section{message manager, \textbf{messaging primitives}}

\begin{itemize}
  \item {\bf Assignments}\\

  In the machine-independant part of the message manager, you will have to
  implement the messaging primitives for sending and receiving messages.
  These primitives will have to be accessible by syscall, to permit
  running tasks to send and receive messages from userspace.

  \item {\bf Interface}\\

\function{message\_async\_send}{(i\_task \argument{sender},
				 i\_node \argument{dest},
				 t\_tag \argument{tag},
				 t\_vaddr \argument{data},
				 t\_vsize \argument{size})}
	 {

	 }

\function{message\_async\_recv}{(i\_task \argument{receiver},
				 t\_tag \argument{tag},
				 t\_vaddr \argument{data},
				 t\_vsize \argument{maxsz},
				 i\_node* \argument{sender},
				 t\_vsize* \argument{msgsz})}
	 {

	 }

\function{message\_sync\_send}{(i\_task \argument{sender},
				i\_node \argument{dest},
				t\_tag \argument{tag},
				t\_vaddr \argument{data},
				t\_vsize \argument{size})}
	 {

	 }

\function{message\_sync\_recv}{(i\_task \argument{receiver},
				t\_tag \argument{tag},
				t\_vaddr \argument{data},
				t\_vsize \argument{maxsz},
				t\_state \argument{blocking},
				i\_node* \argument{sender},
				t\_vsize* \argument{msgsz})}
	 {

	 }




  \item {\bf {Files}}\\

    \begin{tabular}{| l | l |}
      \hline
      machine-independent & {\em kaneton/core/message/message.c}\\
      &  {\em kaneton/include/core/message.h}\\\hline
    \end{tabular}
\end{itemize}

\newpage

\section{message manager, \textbf{IA-32 Syscall Handlers}}
\begin{itemize}
  \item {\bf Assignments}\\

  \item {\bf {Files}}\\

    \begin{tabular}{| l | l |}
      \hline
      machine-dependent & {\em kaneton/core/arch/ibm-pc.ia32-virtual/message.c}\\
      & {\em kaneton/include/arch/ibm-pc.ia32-virtual/core/message.h}\\\hline
    \end{tabular}

\end{itemize}

\section{Task side, \textbf{IA-32 Syscall Triggers}}
\begin{itemize}
  \item {\bf Assignments}\\

  \item {\bf Interface}\\

\function{syscall\_async\_send}{(i\_node \argument{dest},
				 t\_tag \argument{tag},
				 void* \argument{data},
				 t\_size \argument{size})}
	 {

	 }

\function{syscall\_async\_recv}{(t\_tag \argument{tag},
				 void* \argument{buff},
				 t\_size \argument{maxsz},
				 i\_node* \argument{sender},
				 t\_size* \argument{msgsz})}
	 {

	 }

\function{syscall\_sync\_send}{(i\_node \argument{dest},
				t\_tag \argument{tag},
				void* \argument{data},
				t\_size \argument{size})}
	 {

	 }

\function{syscall\_sync\_recv}{(t\_tag \argument{tag},
				void* \argument{buff},
				t\_size \argument{maxsz},
				t\_state \argument{blocking},
				i\_node* \argument{sender},
				t\_size* \argument{msgsz})}
	 {

	 }



  \item {\bf {Files}}\\

    \begin{tabular}{| l | l |}
      \hline
      machine-dependent & {\em kaneton/core/arch/ibm-pc.ia32-virtual/message.c}\\
      & {\em kaneton/include/arch/ibm-pc.ia32-virtual/core/message.h}\\\hline
    \end{tabular}

\end{itemize}
