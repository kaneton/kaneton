%
% ---------- header -----------------------------------------------------------
%
% project       kaneton
%
% license       kaneton
%
% file          /home/mycure/kaneton/view/book/development/source-tree.tex
%
% created       julien quintard   [thu may 17 22:41:36 2007]
% updated       julien quintard   [mon may  4 19:33:22 2009]
%

%
% ---------- source tree ------------------------------------------------------
%

\chapter{Source Tree}
\label{chapter:source tree}

In this chapter we will briefly describe the kaneton microkernel project
source tree.

\newpage

%
% ---------- text -------------------------------------------------------------
%

The kaneton microkernel reference source tree looks like the following
listing:

\begin{verbatim}
  boot/
  cheat/
  configure/
  environment/
  export/
  history/
  kaneton/
  license/
  sample/
  test/
  tool/
  transcript/
  view/
\end{verbatim}

%
% boot/
%

\subsection*{boot/}

The \location{boot/} directory contains the component related to the kaneton
boot process including the \name{bootstrap} and especially the
\name{bootloader}.

The bootstrap is kept for the kaneton educational project while the bootloader
is actually used for setting up the execution context before launching
the kaneton microkernel.

%
% cheat/
%

\subsection*{cheat/}

Since the kaneton microkernel is implemented by students, the kaneton
people need to check whether students are cheating by re-using parts of
previous years projects or other kernel source codes available on the
\name{Internet}.

To avoid cheating, kaneton people developed a software checking for
commonalities between different source codes.

This directory contains scripts that performs these verifications. However,
the students work over the years are not stored in this directory but in
the \location{history/} directory instead.

%
% configure/
%

\subsection*{configure/}

This directory contains everything necessary for configuring its own
kaneton microkernel development environment through the compiling process
to the boot system.

Any new contributor should first look at this directory. However, note that
this directory mainly contains tools targeting final-users rather than
kaneton contributors. Indeed, for instance, the \name{configure} utility
aims at providing a user-friendly way for configuration but does not take
advantage of the power of the kaneton development environment.

Contributors should then learn about how the development environment works
while final-users should use the \name{configure} tool.

%
% environment/
%

\subsection*{environment/}

This directory contains everything necessary to the kaneton development
environment.

The kaneton development environment allows different developers to
interact on the development of the same microkernel in a pretty easy way.

The development environment aims at providing developers to possibility to
work in a collaborative manner without interfering with each other. These
developers are likely to run different operating systems on different
microprocessors. In addition, the kaneton microkernel can be targeted for
different microprocessor architectures. The development environment was
introduced to cope with these combinations by providing profiles, each
profile describing the behaviour of a component: underlying operating system,
target architecture, user-specific stuff \etc{}

As a result, each developer can use a different operating system and
microprocessor architecture with its own specific compiling flags, kaneton
parameters \etc{} without modifying another developer's configuration.

The development environment is detailed in \reference{Section
\ref{section:environment}}.

%
% export/
%

\subsection*{export/}

The \location{export/} directory contains scripts used to generate a kaneton
tarball in order to be distributed to the students at the beginning of the
kaneton educational project.

Indeed, these scripts rearrange the kaneton hierarchy hidding some important
directories the students do not need to be aware of. Moreover some source
code parts are removed since the students have to rewrite these pieces
of code as assignments.

These scripts are also used for making backups and distribution tarbalss of
the kaneton microkernel.

%
% history/
%

\subsection*{history/}

The \location{history/} directory contains the students work over the years
in the universities and schools the kaneton project was used as an operating
system course's implementation material.

The tools of the \location{cheat/} directory use these students works for
performing cheating verifications.

%
% kaneton/
%

\subsection*{kaneton/}

This directory is the most important of the project since it contains
the whole microkernel source code.

The directory is composed of three important subdirectories: \location{core/},
\location{machine/} and \location{include/}. These subdirectories are described
next.

% include/

\subsubsection*{include/}

This directory is the unique include point of the kaneton microkernel.

This directory contains symbolic links to the \location{include/} directories
for the \name{machine}, \name{glue}, \name{platform} and \name{architecture}
components.

% core/

\subsubsection*{core/}

This directory contains the kaneton core source code. The \name{core}
represents the machine-independent source code/

The directory is divided as shown below:

\begin{verbatim}
  as/
  region/
  scheduler/
  segment/
  set/
  task/
  thread/
  [...]
\end{verbatim}

Each directory represents a kaneton core manager. For more information on
the kaneton core, please refer to the appropriate document:
\reference{The kaneton microkernel :: core}

% machine/

\subsubsection*{machine/}

This directory contains the machine-dependent source code.

The machine is composed of three components, the \name{plateform} which
represents the board supporting the devices: microprocessors, memories,
peripherals \etc{}; the \name{architecture} which represents the microprocessor
architecture and finally the \name{glue} which assemble these two
components forming the \name{machine}.

For more information on the kaneton portability system, please refer to the
\reference{The kaneton microkernel} book.

% library/

\subsubsection*{library/}

This directory contains whatever the kernel needs \ie{} very much like
the \name{C} library for userland applications.

% modules/

\subsubsection*{modules/}

This directory contains additional functionalities that can be statically
added to the kernel.

For example, the test system is composed of a kernel part which, when activated,
is compiled and linked with the kernel.

%
% license/
%

\subsection*{license/}

This directory contains the licenses used for any program or document
in relation with the kaneton microkernel project. Indeed, the kaneton
microkernel is under the \name{kaneton license} which is described in
depth in the documents contained in this directory. Note that these licenses
are also available in \reference{Chapter \ref{chapter:licenses}}.

Each student has to read and agree with the kaneton license before
implementing or even using the kaneton microkernel project..

Indeed, every user of the kaneton-related stuff is considered as having
implicitly accepted the kaneton license.

%
% sample/
%

\subsection*{sample/}

This directory contains demonstration servers.

%
% test/
%

\subsection*{test/}

Since the kaneton microkernel is used as a material for operating system
courses, the kaneton microkernel reference, which is the basis of students
work, must be extremely reliable.

The kaneton project therefore contains a set of tools in order to validate
the kaneton reference implementation behaviour. These tools are also used
for evaluating the correctness of the students implementation.

The \location{test/} directory contains the set of kaneton scripts and tests
for validating a kaneton microkernel implementation.

%
% tool/
%

\subsection*{tool/}

This directory contains additional scripts and configuration files used by
the kaneton development environment or the kaneton developers.

As examples, this directory contains scripts for generating prototypes,
building a boot device \etc{}

%
% transcript/
%

\subsection*{transcript/}

This directory contains real-time recorded sessions. These sessions can be
replayed in order to present a feature of the development environment or
of the kaneton microkernel.

%
% view/
%

\subsection*{view/}

This directory contains all the kaneton documents including kaneton
administrative documents, examinations, lectures materials, kaneton papers
and books \etc{}

Additionally, scripts are provided in order to very easily build and
display these documents.
