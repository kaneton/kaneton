%
% ---------- header -----------------------------------------------------------
%
% project       kaneton
%
% license       kaneton
%
% file          /home/buckman/crypt/kaneton/view/curriculum/EPITA/epita.tex
%
% created       julien quintard   [sat oct 20 09:31:28 2007]
% updated       matthieu bucchianeri   [thu oct 25 15:14:18 2007]
%

%
% ---------- path -------------------------------------------------------------
%

\def\path{../..}

%
% ---------- packages ---------------------------------------------------------
%

%
% template
%

\input{\path/template/paper.tex}

%
% header
%

\lhead{\scriptsize{The kaneton microkernel :: EPITA}}

%
% title
%

\title{The kaneton microkernel :: EPITA}

%
% authors
%

\author{\small{Julien Quintard}}

%
% document
%

\begin{document}

%
% title
%

\maketitle

%
% --------- text --------------------------------------------------------------
%

\begin{multicols}{2}

%
% ---------- introduction -----------------------------------------------------
%

\section{Introduction}

kaneton is part of a larger project consisting in an educational
triology composed of:
  \textbf{k}\footnote{http://k.kaneton.org},
  \textbf{kaneton}\footnote{http://www.kaneton.org} and
  \textbf{kayou}\footnote{http://kayou.kaneton.org}; the
\textit{k* educational trilogy}.

Note that the purpose of these three projects remains educational. However,
for each one, there exists a research project in parallel consisting in the
development of a novative operating system.

Thus, people in charge of the teaching of kaneton work in parallel on the
development of the research project. Additionally, past teachers continue
to contribute to the project either by developing or supervising the
new comers.

%
% k
%

\subsection{k}

\textit{k} is an introduction course targeting low-level programming. The
project lasts several weeks and allows students to understand what is the
microprocessor's r\^ole in an operating system. Additionally, this course
allows the students to see what is the link between the user-land applications
and the operating system's kernel.

%
% kaneton
%

\subsection{kaneton}

\textit{kaneton} is probably the most important project of the trilogy. This
project, taught to second-year engineering students, lasts for about five
months. This project focuses on making students fully understand
internals of a micro-kernel based operating system.

%
% kayou
%

\subsection{kayou}

\textit{kayou} is a distributed operating system built over the kaneton
micro-kernel. The kayou's originality resides in its fully distributed
architecture. In such an architecture, all the machines of the network share
their resources with each others including the memory, the processor, the
storage and devices etc. \textit{kayou} is not taught at EPITA, at least
for now. However, that could be the case, especially for the last-year
students.

%
% ---------- history ----------------------------------------------------------
%

\section{History}

During the kaneton history, the project evolved and courses were added
to the curriculum to make the whole kaneton project more interesting and
understandable by the students. Moreover, the educational project, which
was already targeting the \textit{EPITA}'s \textit{System, Network and
Security} major, was also used in other contexts, victim of its success
and of the very hard work achieved by kaneton people over the years.

%
% 2004
%

\subsection{2004}

The first year, a low-level programming introduction course named \textbf{k}
was proposed for the \textit{EPITA} Engineering School's first-year students.

About fourteen hours courses were taught introducing the \textit{Intel 32-bit}
microprocessor's external architecture and low-level programming.

The students had to develop small, poor and messy device drivers for the
console and keyboard peripherals. Moreover, a tiny command interpreter was
developed by students so that a kernel action could be triggered by entering
a command.

The course was a bit chaotic but this first shot was a success.

Therefore, the students majoring in \textit{System, Network and Security}
asked the two students \textit{Julien Quintard} and \textit{Jean-Pascal
Billaud} a complete kernel project for their curriculum so that they can
learn more about operating systems internals.

%
% 2005
%

\subsection{2005}

The two, still students, \textit{Julien Quintard} and \textit{Jean-Pascal
Billaud} then prepared a complete microkernel design the students will have
to implement. This was the premises of the \textbf{kaneton microkernel
educational project}. Additionally, two complete courses on kernel design and
\textit{Intel 32-bit Architecture} programming were prepared.

The project was composed of six steps, from the bootstrap, passing by
the kernel internals including memory management, task management etc.
to the servers with an \textit{IDE} device driver and finally a \textit{FAT}
file system.

Notice that the majority of the students did not success in implementing a
complete scheduling system allowing the creation of user-land tasks. Indeed,
the best groups achieved in providing the management of kernel-land tasks only.
Therefore, the \textit{IDE} driver, \textit{FAT} file system etc. were
running inside the kernel.

Inspite of this, once again, the whole project was a success. However,
kaneton people noticed that the students took much time doing boring work
like filling in header files, dealing with versionning problems, writing
\textit{Make} files and \textit{Shell} scripts etc.

Moreover, the courses were too messy and the students had difficulties
to make the relation between the kaneton design and the microprocessor's
architecture implementation.

As a result, kaneton people decided to start implementing a kaneton microkernel
reference by their own in the \textit{C} language. This implementation will
then be used to compare the behaviour of students' implementation with
the reference. Moreover, this implementation led to the creation of a
new project: the \textbf{kaneton microkernel research project}.

%
% 2006
%

\subsection{2006}

While \textit{Jean-Pascal Billaud} leaved the project, people joined it
starting with \textit{EPITA} last-year students \textit{C\'edric Aubouy},
\textit{Renaud Lienhart} but also \textit{Fabien Le-Mentec} from
\textit{EPITECH} who knew these people from the \textit{EPITA Computer Systems
Laboratory} where they were all working together a year before.
\textit{C\'edric Aubouy} and \textit{Renaud Lienhard} were in charge of the
kernel and \textit{Intel 32-bit Architecture} courses, respectively.
\textit{Julien Quintard} was still in charge of the kaneton educational
project taught to the students.

Moreover two \textit{EPITA} first-year students joined the \textit{EPITA
Computer Systems Laboratory}, \textit{Matthieu Bucchianeri} and \textit{Renaud
Voltz}. Indeed, from this date, the \textit{EPITA Computer Systems Laboratory}
was a strong partner of the kaneton microkernel project. These two students
were hired for contributing to the development of the kaneton research project.
Moreover, these students were supposed to teach and supervise the kaneton
educational project the following year.

\textit{Matthieu Bucchianeri} and \textit{Renaud Voltz} did an amazing work
on the kaneton research project implementation. Indeed, most of the
code related to the \textit{Intel 32-bit Architecture} comes from them. In
addition, the test suite as well as many tests were written by them.

This year, kaneton people decided to introduce a development environment,
based on the kaneton research reference implementation, including everything
necessary to set up a collaborative kernel development.

While, previously, the students had to write the entire microkernel and
servers from scratch, this year, students only had to write precise parts
of the microkernel including some set implementations, memory management,
task scheduling etc.

Few mistakes were made especially about the choice of parts the students
had to implement. Indeed, asking the students to implement set implementations
like linked-list, array etc. was a very bad idea. This year, the project
was not completed and students stopped the project before the messaging
system implementation.

A course was also added to the \textit{EPITA} \textit{System, Network
and Security} major's curriculum about microprocessors' internals. This
course was introduced and taught by \textit{Julien Quintard}.

In conclusion, the kaneton educational project was not a real success this year
and needed some modifications. For instance, the course about the \textit{Intel
32-bit Architecture} was too specific and hard to understand but also hard
to teach. Instead, kaneton people decided to introduce a more general course
about kernel principles for the next year.

The kaneton research project implementation, in 2006,
  counted\footnote{Estimations realised with the software \textit{sloccount}.}
about \textit{7,000} lines for the \textit{core} and about \textit{2,000}
lines for the \textit{Intel 32-bit Architecture} implementation.

%
% 2007
%

\subsection{2007}

People affiliated with the \textit{EPITA Computer Systems Laboratory} joined
the project: \textit{Pierre Duteil} and \textit{Julian Pidancet}. Moreover,
students who implemented the kaneton educational project the previous year
decided to join the project: \textit{Enguerrand Raymond} and \textit{Mathieu
S\'elari\`es}, mainly working on the \textit{MIPS Architecture} portage among
other contributions.

This year, \textit{Matthieu Bucchianeri} and \textit{Renaud Voltz} were in
charge of the educational project by giving the kaneton courses as well
as supervising students' educational implementations.

As the kaneton research implementation was much more advanced as in 2006,
the students were given more code and then focused only on interesting and
system-related parts.

Students totally implemented the physical and virtual memory management, the
event and timers, the thread manager, the scheduler and the messaging system.
As for the previous years, the implementation was based on the \textit{Intel
32-bit Architecture}.

This year, the whole kaneton educational project was also given to students
from the \textit{Realtime \& Embedded Systems} specialization, for a total
of about $50$ students. The project was evaluated using a test suite,
developed for the kaneton research project, of about a hundred tests.

This year, the kaneton educational project was an amazing success as many
students completed a working microkernel, able to run tasks and to implement
some servers running on top of the kaneton microkernel.

The kaneton research implementation has grown to \textit{9,000} lines of source
code for the \textit{core} and \textit{5,500} lines for the microprocessor's
architecture implementation on \textit{Intel 32-bit}. The kaneton research
implementation was able to start modules - as standalone binaries - in
user-land as well as to make them communicate through the kaneton messaging
system.

This year, \textit{Pierre Duteil} leaved the project. Since the project
needed two students for teaching kaneton to the second-year students,
\textit{Elie Bleton} joined the project. As a first-year student, he had
to work by himself to learn everything about the kaneton concepts and
implementation.

This year was not as good as people were expecting it to be. As a result,
kaneton people decided to re-organise the curriculum of students working
on kaneton so that they can learn everything about kaneton in a very
short period of time to be then able to work on their project without any
lack of knowledge.

%
% ---------- schedule ---------------------------------------------------------
%

\section{Schedule}

Until 2007, two students were recruited every year, in January, via the EPITA
Computer Systems Laboratory. These students were assigned a project and had
to work on it from February to the end of July.

The project assigned was, in the first years, directly related to the
development of the kaneton research project \textit{i.e} the reference
implementation. Through these projects, the recruited students discovered
and learned the concepts related to kaneton: micro-kernel design,
\textit{IA-32} microprocessor external architecture etc.

Unfortunately, this is no longer the case. Indeed, the development of the
kaneton reference reaches its end. Thus, the new recruited students do not
have the possibility to learn through their project since the
\textit{IA-32}-related source code is already developed.

The next steps relate to the operating system, \textit{kayou}.

Since students cannot learn about the kaneton design and \textit{IA-32}
programming, they will not be capable of teaching the kaneton courses and
project to the second-year students of EPITA.

As a result, in order to make students capable of teaching, they have to
be taught the fundamentals by older kaneton people. This reasoning led to
the curriculum's schedule described below.

The timetable below describes the teaching of the \textit{k* triology's}
projects. Assistants are named \textit{``Poussins''} followed by the year
they have been recruited. For convenience and clarity, three years of the
EPITA's curriculum are detailled: $\alpha$, $\beta$ and $\gamma$.

%
% alpha
%

\subsection{$\alpha$}

XXX

%
% beta
%

\subsection{$\beta$}

XXX

%
% gamma
%

\subsection{$\gamma$}

XXX

%
% ---------- k ----------------------------------------------------------------
%

\section{k}

k is a short but complete introduction to low-level programming and
operating system basics.

Students - in groups of four - will develop a tiny monolithic kernel
intended to run very simple applications in a mono-task environment.

While dealing with many fundamental aspects of operating systems like
device drivers and system calls, the project is funny and visual. The
programs to run are tiny 2D-arcade games with graphic rendering and
sound.

The project comes with a few lessons:

\begin{itemize}
  \item
    Introduction to memory management, presenting the segmentation
    mechanism.
  \item
    Presentation of the x86 calling convention.
  \item
    Event handling, including hardware interrupts.
  \item
    Privilege modes and system calls.
  \item
    Device driver implementation and filesystems.
  \item
    Binary formats and ELF loading.
\end{itemize}

%
% project
%

\subsection{Project}

The project is divided into several parts:

\begin{itemize}
  \item
    \textbf{pm manager} that takes care of memory management.
  \item
    \textbf{event} and \textbf{syscall manager} handling external
    event and userland to kernelspace transitions.
  \item
    \textbf{cons}, \textbf{vga} and \textbf{speaker manager} for
    multimedia operations.
  \item
    \textbf{kbd} and \textbf{mouse manager} to provide user inputs.
  \item
    \textbf{time manager} to measure time intervals.
  \item
    \textbf{fs manager} to manage the root filesystem.
\end{itemize}

The project lasts two months and is concluded by an evaluation of the
final projects with each groups.

%
% ---------- kaneton ----------------------------------------------------------
%

\section{kaneton}

The kaneton microkernel project's goal is to lead students to understand
what really is an operating system and more precisely a kernel.

Every group, composed of two students, will have to develop parts of
the kaneton microkernel.

To simplify the project, each group receives a development environment
containing everything necessary to start the project including a
working microkernel base, documentation, assignments etc.

The project comes with two fundamental courses:

\begin{itemize}
  \item
    \textbf{Kernel}: this course explores the kernels internals including
    microkernel architectures, memory management, processes and threads,
    synchronisation, communications, and complete case studies.
  \item
    \textbf{MIPS architecture}: this course is dedicated to the MIPS internal
    architecture although this course actually explains modern microprocessors
    concepts: pipelining, optimizations, caches etc.
\end{itemize}

%
% project
%

\subsection{Project}

The whole kaneton project is subdivided into stages:

\begin{itemize}
  \item
    \textbf{k0}: this project will be entirely developed during a
    special coding session of about 6 hours and under the teachers'
    supervisation. This project consists in an introduction to the
    IA-32 external architecture: basic memory management model,
    IA-32 assembly language, development tools etc.
  \item
    \textbf{k1}: this project will lead the students to an higher abstraction
    level. The goal of the project is to develop the segment manager to be
    able to manage physical memory and the architecture-dependent part of the
    region manager to be able to control the virtual memory. This project
    is \textbf{two weeks} long.
  \item
    \textbf{k2}: this project introduces the interrupts management and
    the driver development. Indeed, the student will have to install
    everything necessary to handle interrupts. Then, some drivers will
    be developed including the keyboard, the timer and a demonstration shell.
    This project is \textbf{two weeks} long.
  \item
    \textbf{k3}: the students will have to provide everything necessary
    to handle execution contexts. Indeed, the student will have to
    develop the scheduler but also to implement the context switchs from
    the microprocessor point of view. This project is \textbf{three weeks}
    long
  \item
    \textbf{k4}: this project introduces the communication into the
    microkernel. Indeed, the students will have to provide some
    communication primitives including sychronous and asynchronous
    functions as well as blocking and non-blocking functions. This project
    is \textbf{two weeks} long.
\end{itemize}

%
% mips architecture
%

\subsection{MIPS Architecture}

\textit{Name}: \textbf{MIA}

\textit{Hours}: \textbf{30 hours} divided into \textbf{10 sessions}

This course is intended to give students a complete view of how a RISC
microprocessor works and what choices the designers made to build the
future modern microprocessors.

Below are listed the concepts studied in this course:

\begin{itemize}
  \item
    External architecture: we will study the instructions set,
    the memory management model etc.
  \item
    Pipeline: we will study the MIPS pipeline, its inherent problems
    and limitations. Advanced pipelines will also be studied.
  \item
    Compiler optimisations: we will study the different direct assembly
    source code optimisations: rescheduling, software pipelining etc.
  \item
    Memory: we will study the bus used on the MIPS processor and
    the different cache management techniques.
\end{itemize}

The list below details the different sessions for the MIPS architecture
course:

\begin{enumerate}
  \item
    Course presentation, MIPS history, introduction to MIPS external
    architecture: registers and instructions set. Introduction to
    instruction formats and to inherent limitations. (3 hours)
  \item
    End of instruction formats introduction, explanations of architecture
    designers choices: MIXs and Amdhal Rule. Some exercises to practice.
    Introduction to MIPS architecture addressing and to MIPS pipeline.
    (3 hours)
  \item
    Introduction to MIPS spirit and to its pipeline. Moore Law and
    pipeline rules. Introduction to different pipeline representations:
    simplified and detailed. Some exercises to pratice these representations.
    (3 hours)
  \item
    We will study in this session the next instruction address computation
    problem and the delay slot. Then, study of branch instruction and their
    problems and limitations. Some exercises to pratice. (3 hours)
  \item
    Complete study of instruction dependencies. Some exercise to practice.
    (3 hours)
  \item
    Partial exam correction. Introduction to optimisations. (3 hours)
  \item
    Study of different optimisations used by compilers. Study of
    advanced pipelines: superpipeline, superscalar pipelines etc. (3 hours)
  \item
    Introduction to the Pi-Bus. Then complete study of memory including
    cache management. (3 hours)
  \item
    End of memory course. Some exercises to practice. (3 hours)
  \item
    Revisions for the final exam. (3 hours)
\end{enumerate}

%
% kernel
%

\subsection{Kernel}

\textit{Name}: \textbf{KER}

\textit{Hours}: \textbf{26 hours} divided into \textbf{9 sessions}

This course is intended to give the students a general overview of
kernel internals and its problematics.

Below are listed the studied notions:

\begin{itemize}
  \item
    Understand how kernel developpement evolves and why, receive a
    minimal general culture on kernel internals and history.
  \item
    We will see how to manage and share common resources (memory,
    execution time) with increasing constraints and needs.
  \item
    The microprocessor's facilities are detailed to get the students
    to fully understand the mechanisms. Examples are taken from
    many different architectures.
  \item
    The common kernel design issues will be totally understood by the
    students and they will be able to build their own design.
  \item
    The course aims at giving the students a precise idea of how it
    works inside, thus giving them the ability to fully understand
    the kaneton project.
\end{itemize}

The list below details the different sessions for the kernel course.

\begin{enumerate}
  \item
    \textbf{Recalls and prerequisites}: presentation of the diffent
    kind of kernels and the role in an operating system. Recalls of
    low-level basics (3 hours).
  \item
    \textbf{Bootstrap}: details about processor bootup and bootloading
    (2 hours)
\item
    \textbf{Memory management - part one}: fundamental concepts of
    memory management, overview of memory management unit and address
    translation though paging (3 hours).
  \item
    \textbf{Memory management - part two}: high-level mechanisms like
    page swapping, copy-on-write, etc. Presentation of most known
    allocation algorithms (3 hours).
  \item
    \textbf{Events and I/O - part one}: interrupt mechanism, interrupt
    vector and processor running modes (3 hours).
  \item
    \textbf{Events and I/O - part two}: hardware interrupts, interrupt
    controllers, port-mapped input/output, memory-mapped input/output
    (3 hours).
  \item
    \textbf{Task and scheduling - part one}: recalls on
    multiprogramming, execution context, context switching (3 hours).
  \item
    \textbf{Task and scheduling - part two}: process control block on
    known operating systems, task life cycle, scheduling automaton,
    scheduling algorithms (3 hours).
  \item
    \textbf{Inter-Process Communication}: \textit{IPC} in a microkernel,
    message passing, classical \textit{IPC}, locking (3 hours).
\end{enumerate}

%
% ---------- preparation ------------------------------------------------------
%

\section{Preparation}

XXX[lister ce que doit faire chaque poussins, plus precisement pour les cours
    des inge2]

%
% ---------- project suggestions ----------------------------------------------
%

\section{Project Suggestions}

This section contains some project suggestions for the new \textit{Poussins}.

%
% security
%

\subsection{Security}

Security is a very important topic in operating system, even more in
distributed systems. Indeed, in such a system, resources are completely
shared among the machines of the system. It is therefore crucial to protect
these resources from being accessed by unauthorised entities.

This project consists in designing and implementing a complete security
model composed of some in-kernel primitives as well as at the operating
system level.

For now, the kaneton microkernel provides the concept of \textit{capabilities}
which seems to perfectly fit the distributed systems' requirements. The student
will have to confirm that this concept is suitable for our needs. The student
will also have to complete the current implementation in order to move to
the study of the security in the operating system, even its in distributed
form.

A possibly suitable access control scheme could be the RBAC - Role-Based
Access Control. The student will have, once again, to confirm this
possibility via a preliminary study and then implement the services
necessary to this scheme so that applications can use it.

The student will have to tackle the notion of multi-users at the operating
system level. Indeed, although this notion is integrated at the kernel
level in every \textit{UNIX} system, kaneton designers decided to handle this
notion outside the microkernel.

The student will then have to study this concept and implement the necessary
services. Besides, the student could also investigate further in order
to develop a security service based on the concept of user.

%
% posix
%

\subsection{POSIX}

kaneton provides its own interface whish has nothing to do with interfaces
of others \textit{UNIX} like \textit{Linux}, \textit{BSD} or others etc.

\textit{POSIX} is an interface which was introduced in order to normalise the
\textit{C Library} layer. Most applications --- at least in the \textit{UNIX}
world --- rely in this software layer.

If we want our operating system to benefit from the already existing and
futures softwares without having to re-develop everything, we need to develop
a software layer complying to the \textit{POSIX} standard. In our case,
the \textit{POSIX} functionalities must be translated into either
functionalities provided either by kaneton or one or more micro-kernel
servers.

The student will have to study very precisely the \textit{POSIX} standard
as well as the kaneton interface in order to develop the emulation library:
\textit{libposix}.

In order to test the library, the student will be in charge of porting some
services and applications. Since \textit{UNIX} highly relies on the concept
of \textit{files}, it is very likely that the student will have to port
or develop a hard-disk driver as well as a basic file system.

The student could take advantage of the different work existing on the
Internet, especially \textit{LSE/OS} which was designed and implemented
at the EPITA Computer Systems Laboratory.

%
% amd64
%

\subsection{AMD-64}

This project consists in porting kaneton to a new microprocessor architecture,
in this case, \textit{AMD-64}.

This architecture is very interesting for two reasons. First, \textit{AMD}
architectures have many in common with \textit{IA32} ones. Since, kaneton
already supports \textit{IA-32}, it would be easy to support this new
architecture. Secondly, this architecture runs in 64-bit and its implementation
could reveal design mistakes and/or implementation bugs in the generic
part of the microkernel, commonly called \textit{core}. Besides, supporting
an additional architecture means that the kaneton's portability scheme
is correct.

The student will have to study a complete new architecture by reader the
microprocessor specifications. Besides, the student will have to report
any problem encountered in his project, especially about the microkernel's
design. Types handling in the \textit{core} is very likely to be problematic
for example.

The student will have to modify several parts in the kernel but also
make suggestions about design improvements based on his observations.

Besides, the student will have to complete the microkernel implementation
in various ways: functionality not implemented yet, bugs correction, error
handling improvement, etc.

%
% mips
%

\subsection{MIPS-64}

This projects simply consists in contributing to the portage of kaneton
on the \textit{MIPS-64} architecture.

The remarks about the \textit{AMD-64} project apply here as well.

%
% dht
%

\subsection{DHT}

This project consists in developing a \textit{DHT} --- Distributed Hash Table.
This abstraction is crucial for distributed applications as these applications
need to store data and make them accessible to the other nodes of the
distributed system.

The \textit{DHT} is built over what is called a \textit{KBR} --- Key-Based
Routing. The r\^ole of this \textit{KBR} is to, given a key, locate the
node which is in charge for storing a piece of data.

This \textit{DHT} will be heavily used in kayou, especially for the distributed
file system, but could also be used by many distributed applications.

There does not exist any good implementation of such \textit{DHT}. Indeed,
the well-known implementations were written in Java and are therefore
useless in a true system where performances matter.

The student will have to briefly study this research field through the
well-known papers and projects: Chord, \textit{CAN}, Pastry etc. and then
to design and finally implement the complete \textit{DHT}.

This project is clearly research-oriented since the concepts directly come
from research. However, many firms are highly interested in such a
performant and secure implementation in order to build large-scale storage
systems.

\end{multicols}

\end{document}

%
% ---------- XXX --------------------------------------------------------------
%

XXX intro + history [DONE]
XXX ensuite mettre l'organisation d'un cursus de poussin [TODO]
XXX liste des cours a partir du document schedule [~]
XXX ensuite mettre ce que chaque poussins doit faire dans chaque de
    ses phases. par exemple le poussins + 1 doit donner les cours de remise
    a niveau, refaire la decoupe de la tarball, clean l'intra, preparer la
    pres aux inge2 mais egalement le recrutement inge1 avec des idees de
    projet etc. grace a ca, un poussin aura a lire ce qu'il doit penser
    a faire. [TODO]
XXX finir avec des idees de projet [DONE]
